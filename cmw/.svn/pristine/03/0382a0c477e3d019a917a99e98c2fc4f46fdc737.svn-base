<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>wetoken</title>
		<#include "/common/head.xhtml"/>
	</head>
	<style type="text/css">
		body{
			height: 100vh;
		}
		.guide{
			background:url(/active/assets/image/guidebg.jpg) no-repeat #f25a21;
			background-size: cover;
		}
		header{
			width: 1200px;
		margin: 0 auto;}
		header .header-logo{
			position: absolute;
			left: 30px;
			top: 30px;
		}
		header .header-btn{
			top: 30px;
			position: absolute;
			right: 30px;
		}
		.guidetitle{
			padding-top: 60px;
			margin-bottom: 40px;
		}
		.guidetxt{
			margin: 20px 0;
			padding: 10px 100px;
			border: 1px solid #fff;
			color: #fff;
			display: inline-block;
			border-radius: 30px;
			background: rgba(0,0,0,0.1);
			font-size: 20px;
		}
		.guideleft{
			width: 50%;
			float: left;
			position: relative;
			overflow: visible;
		}
		.guideleft img{
			position: relative;
			right: 100px;
		}
		.guidecon .container{
			overflow: visible;
			display: table;
		}
		.guideright{
			width: 50%;
			float: right;
			height: 600px;
			text-align: left;
		}
		.guideright .right-title{
			background: #fff;
			margin-bottom: 10px;
			border-radius: 4px;
			overflow: hidden;
			position: relative;
			
		}
		.guideright .right-title .rlogo{
			width: 230px;
			background: #ffbe40;
			text-align: center;
			padding: 15px 0;
		}
		.guideright .right-title .rnum{
			position: absolute;
			right: 70px;
			top: 10px;
			width: 250px;
			font-size: 26px;
		}
		.guideright .right-title font{
			position: absolute;
			right: 30px;
			top:0px;
			height: 60px;
			line-height: 60px;
			color: #f65e25;
			font-weight: 400;
			font-size: 16px;
		}
		.guideformleft{
			width: 230px;
			float: left;
		}
		.guideformleft img{
			width: 100%;
			margin-bottom: 10px;
			
		}
		.guideformright{
			background: #fff;
			border-radius: 4px;
			height: 510px;
			width: 360px;
			float: right;
		}
		.guideformright .formlogo{
			text-align: center;
			padding: 20px 0;
		}
		.runNum{
            margin: 0 auto;
            padding: 0;
            overflow: hidden;
            height: 40px;
            line-height: 40px;
            text-align: center;
            font-weight: bold;
            position: relative;
        }
        .runNum>li{
            list-style: none;
            width: 40px;
            float: left;
            position: absolute;
    			color: #fff;
           
        }
        .runNum>li div{
        		background: url(/active/assets/image/nbgrpet.png) repeat-x;
        		border-radius: 4px;
        		margin-right: 5px;
        }

		.guideformright form{
			width: 80%;
			margin: 0 auto;
		}
		.guideformright form ul li{
			margin-bottom: 10px;
			position: relative;
		}
		.guideformright form ul li input{
			width: 80%;
			padding: 0 5%;
			padding-left: 15%;
			height: 50px;
			line-height: 50px;
			outline: none;
			border: 1px solid #cccccc;
			border-radius: 4px;
			font-size: 16px;
		}
		.guideformright form ul li.fcode .telcode{
			display: inline-block;
			position: absolute;
			right: 10px;
			top:10px;
			border-left: 1px solid #999;
			padding-left: 10px;
			text-align: center;
			width: 90px;
			
		}
		.guideformright form ul li.fcode .telcode a{
			color: #ff852b;
		}
		.guideformright form ul li.fcode .telcode a:hover{
			font-weight: bold;
		}
		.guideformright form ul li.ftel input{
			background:url(/active/assets/image/r-01.png) no-repeat 10px center #f8f8f8;
			background-size: 15px;
		}
		.guideformright form ul li.fcode input{
			background:url(/active/assets/image/r-02.png) no-repeat 10px center #f8f8f8;
			background-size: 15px;
		}
		.guideformright form ul li.fpswd input{
			background:url(/active/assets/image/r-03.png) no-repeat 10px center #f8f8f8;
			background-size: 15px;
		}
		.guideformright form input[type=submit]{
			width: 100%;
			height: 50px;
			line-height: 50px;
			background:#ff852b;
			color: #fff;
			border: none;
			border-radius: 4px;
			font-size: 18px;
		}
		.guideformright .agcon{
			margin-bottom: 20px;
			text-align: center;
		}
		footer{
			width: 100%;
			background: #fff;
			position:fixed;
			bottom: 0;
			text-align: center;
			height: 60px;
			line-height: 60px;
		}
		.sharelink{
			position: absolute;
			right: 30px;
			top:10px;
			
		}
		.sharelink h5{
			display: inline-block; float: left;
			line-height: 44px;
			font-size: 16px;
		}
		.sharelink a{
			float: right;
			margin-left: 10px;
		}
		.guideformright form ul li.fcode .telcode.hide {
		    display: none;
		}
		.guideformright form ul li.fcode .telcode.show {
		    display: block;
		}
		#smsSend a{color: #999}
		.fromtips{display: block; text-align: center; margin-bottom: 20px}
		
	</style>
	<body class="guide">
		<header>
			<div class="header-logo">
				<img src="/active/assets/image/logo-07.png" class="" width="240"/>
			</div>
			<div class="header-btn">
				<a href=""><img src="/active/assets/image/header-btn.png" width="130"/></a>
			</div>
		</header>
		<section class="guidecon">
			
			<div class="container" style="text-align: center;">
				<div class="guidetitle">
					<img src="/active/assets/image/guidetitle.png" width="90%"/>
					<div class="guidetxt">
						100여종의 암호화폐 에어드랍 ! 선착순 지급 !
					</div>
				</div>
				<div class="guideleft">
					<img src="/active/assets/image/guide-left.png" width="100%"/>
				</div>
				<div class="guideright">
					<div class="right-title">
						<div class="rlogo">
							<img src="/active/assets/image/logo-07.png"  width="180"/>
							
						</div>
						<div class="rnum">
							<ul class="runNum" id="test"></ul>
						</div>

						<font><span style="margin-right: 10px;">명</span>수령 완료</font>
					</div>
					<div class="guideformleft">
						<img src="/active/assets/image/guide-nb1.png"/>
						<img src="/active/assets/image/guide-nb2.png"/>
					</div>
					<div class="guideformright">
						<div class="formlogo">
							<img src="/active/assets/image/logo.png" alt="" width="200"/>
						</div>
						<form action="/register" method="post" onsubmit="return check(this)">
							<input type="hidden" name="url" id="url" value="${(url)!}" />
							<input type="hidden" name="flag" id="flag" value="1" />
							<ul>
								<li class="ftel"><input type="tel" name="phone" id="phone" value="${(phone)!}" placeholder="휴대폰 번호"/></li>
								<li class="fcode"><input type="text" name="code" id="code" value="${(code)!}" placeholder="인증번호"/>
									<div id="getSms" class="telcode"><a href="javascript:;">인증번호<br/>발송</a></div>
									<div id="smsSend" class="telcode hide" style="top: 20px"><span id="but_time" disabled="disabled" style="font-size: 16px;color: #ff852b"></span></div>

								</li>
								<li class="fpswd"><input type="password" name="password" id="password" value="" placeholder="비밀번호" />
									<div class="password-security">
											<div class="security-ico">
												<div class="view active"></div>
												<div class="view "></div>
												<div class="view"></div>
												<div class="levelcon">
													하중상：
													<font id="level">하</font>
												</div>
											</div>
											<p><span class="passlang pass1" id="newLengthtip">비밀번호는 최소 6자리 이상 이여야 합니다</span></p>
											<p><span class="passlang pass2">영문 (대/소문자),숫자,특수 문자를 조합해서 작성해주세요</span></p>
										</div>
								</li>
								<li class="fpswd"><input type="password" name="password2" id="password2" value="" placeholder="비밀번호 재확인" /></li>
							</ul>
							<div class="agcon">
								<label for="agreement"><input type="checkbox" name="checkbox" checked ="checked" id="agreement" >이용약관 전체동의<a href="/agreement.xhtml" target="_blank">개인정보 수집 안내</a></label>
							</div>
							<div id="msgDiv">
								<#if msg??><span class="fromtips">${(msg)!}</span></#if>
							</div>
							<input type="submit" id="loginbtn" value="회원가입"/>
						</form>
					</div>
				</div>
			</div>
		</section>
		<footer>
			<div class="icp">
				Copyright © 2018 CANDY.CLUB. All Rights Reserved.
			</div>
			<div class="sharelink">
				<h5>공식 커뮤니티: </h5>
				<a href=""><img src="/active/assets/image/ico-facebook.png" width="40"></a>
					<a href=""><img src="/active/assets/image/ico-twitter.png" width="40"></a>
					<a href=""><img src="/active/assets/image/ico-talk1.png" width="40"></a>
					<a href=""><img src="/active/assets/image/ico-telegram1.png" width="40"></a>
			</div>
		</footer>
		<script src="/active/assets/js/jquery-1.12.3.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="/active/js/main.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			$("#password").focus(function() {
				$(".password-security").show();
			})
			$("#password").keyup(function() {
				checkLevel("#password");
			})

			$("#password").blur(function() {
				$(".password-security").hide()
			})

			$('#agreement').click(function(e){
				$(this).val($(this).is(":checked"));
			})

			$("#getSms").click(function(e) {

				var phone = $("#phone").val();
				if(!phone || '' == phone) {
					printTip("올바른 핸드폰 번호를 입력해주세요");
					return;
				}
				if(!regTestPhone(phone)){
					printTip("올바른 전화번호를 입력해주세요");
					return;
				}
				var jsonData = {
					"reqKey": phone,
					"flag": 10,
				}
				$.post("/dynamicKey", jsonData, function(ret) {
					if(0 != ret.code) {
						printTip(ret.msg);
						return;
					}
					var key = ret.data;
					if(!key || key.indexOf(",") < 0) {
						return;
					}
					var data = key.split(",");
					jsonData = {
						"phone": phone,
						"data": data[0],
						"timestamp": data[1]
					}
					//发送验证码
					$.post("/sendSms", jsonData, function(ret) {
						if(0 != ret.code) {
							printTip(ret.msg + "");
							//$("#msgDiv").html(ret.msg).removeClass("hide").addClass(".show-inline");
						} else {
							//切换发送验证码的button
							$("#msgDiv").html('');
							$("#smsSend").removeClass("hide").addClass("show");
							$("#getSms").removeClass("show").addClass("hide");
							beginCount(60);
							//$("#msgDiv").removeClass(".show-inline").addClass("hide");
						}
					});
				});

			});

			function toVaild(phone, pwd1, pwd2, code,agreement) {
				$("#msgDiv").html('');
				if(!agreement){
					printTip("이용약관을 확인하고 동의해주세요");
					return false;
				}
				if(!phone || phone == "") {
					printTip("올바른 핸드폰 번호를 입력해주세요");
					return false;
				}
				if(!regTestPhone(phone)){
					printTip("올바른 전화번호를 입력해주세요");
					return false;
				}
				if(!code || code == "") {
					printTip("인증번호를 입력해주세요");
					return false;
				}
				if(!pwd1 || pwd1 == "") {
					printTip("비밀번호를 입력해주세요");
					return false;
				}
				if(pwd1.length < 6) {
					printTip("비밀번호가 올바르지 않습니다");
					return false;
				}

				if(pwd1 != pwd2) {
					printTip("비밀번호가 불일치 합니다");
					return false;
				}
				return true;
			}

			function check(form) {
				const phone = form.phone.value;
				const password = form.password.value;
				const password2 = form.password2.value;
				const code = form.code.value;
				const agreement = $('#agreement').is(":checked");
				return toVaild(phone,password,password2,code,agreement);
			}

			function printTip(msg) {
				$("#msgDiv").html("<span class='fromtips'>" + msg + "</span>");
			}

			function validPhone() {
				var $phone = document.getElementById("phone");
				const regNum = /(\D+)*/g;
				var context = $phone.value;
				context = context.replace(regNum, "");
				context = context.substring(0, 11);
				$phone.value = context;
			}

			function validCode(){
				var $code = document.getElementById("code");
				var context = $code.value;
				context = context.substring(0, 8);
				$code.value = context;
			}
			document.getElementById("code").onchange = function() {
				validCode();
			}

			$("#code").keyup(function() {
				validCode();
			})

			document.getElementById("phone").onchange = function() {
				validPhone();
			}

			$("#phone").keyup(function() {
				validPhone();
			})
		</script>
		<script type="text/javascript">
    (function ($) {
    	/*jQuery对象添加  runNum  方法*/
        $.fn.extend({
        	/*
        		*	滚动数字
				*	@ val 值，	params 参数对象
				*	params{addMin(随机最小值),addMax(随机最大值),interval(动画间隔),speed(动画滚动速度),width(列宽),height(行高)}
        	*/
            runNum:function (val,params) {
                /*初始化动画参数*/
                var valString = val || '0'
                var par= params || {};
                var runNumJson={
                    el:$(this),
                    value:valString,
                    valueStr:valString.toString(10),
                    width:par.width || 40,
                    height:par.height || 40,
                    addMin:par.addMin || 10000,
                    addMax:par.addMax || 99999,
                    interval:par.interval || 3000,
                    speed:par.speed || 500,
                    width:par.width || 40,
                    length:valString.toString(10).length
                };
                $._runNum._list(runNumJson.el,runNumJson);
                
            }
        });
        /*jQuery对象添加  _runNum  属性*/
        $._runNum={
            /*初始化数字列表*/
            _list:function (el,json) {
                var str='';
                for(var i=0; i<json.length;i++){
                    var w=json.width*i;
                    var t=json.height*parseInt(json.valueStr[i]);
                    var h=json.height*10;
                    str +='<li style="width:'+json.width+'px;left:'+w+'px;top: '+-t+'px;height:'+h+'px;">';
                    for(var j=0;j<10;j++){
                        str+='<div style="height:'+json.height+'px;line-height:'+json.height+'px;">'+j+'</div>';
                    }
                    str+='</li>';
                }
                el.html(str);
            },
            /*生成随即数*/
            _random:function (json) {
                var Range = json.addMax - json.addMin;
                var Rand = Math.random();
                var num=json.addMin + Math.round(Rand * Range);
                return num;
            },
            /*执行动画效果*/
            _animate:function (el,value,json) {
                for(var x=0;x<json.length;x++){
                    var topPx=value[x]*json.height;
                    el.eq(x).animate({top:-topPx+'px'},json.speed);
                }
            },
            /*定期刷新动画列表*/
            _interval:function (el,json) {
                var val=json.value;
                setInterval(function () {
                    val+=$._runNum._random(json);
                    $._runNum._animate(el,val.toString(10),json);
                },json.interval);
            }
        }
    })(jQuery);
</script>
<script type="text/javascript">
	var initNum=1000;
	$("#test").runNum(initNum);
	getTimeDate();
	function getUserNum(){
		$.get("/getUserNum.xhtml", {initNum:Number(initNum)},function(ret) {
			initNum=Number(ret);
			$("#test").runNum(initNum);
			
		})
	}
	function getTimeDate(){	
		tt=setInterval("getUserNum()",3000);	
	}
	
	
</script>
	</body>
</html>
