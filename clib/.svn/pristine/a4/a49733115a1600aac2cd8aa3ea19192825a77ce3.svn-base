package com.we.common.utils;


import javax.mail.Message;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;

import org.apache.commons.mail.EmailException;
import org.apache.commons.mail.SimpleEmail;

import java.util.Properties;

public class MailUtil {
	public static void main(String[] args) {
		// javamail 发邮件
		MailUtil.sendMailByJava("810522154@qq.com", "您的密码", "您的密码为:123456");
		MailUtil.sendMailByApache("810522154@qq.com", "apache", "apache send您的密码为:123456");

		// apache email 发邮件
		//MailUtil.send();

	}
	
	public static final String smtphost = "smtp.gmail.com"; // 发送邮件服务器
	public static final String user = "admin@candy.club"; // 邮件服务器登录用户名
	public static final String password = "sz1992229"; // 邮件服务器登录密码
	public static final String from = "admin@candy.club"; // 发送人邮件地址

	/**
	 * 发送电子邮件
	 * 
	 * @param to
	 *            接收者的email地址
	 * @param subject
	 *            eamil标题
	 * @param body
	 *            email内容
	 * @return
	 */
	public static boolean sendMailByJava(String to, String subject, String body) {

		// 以下为发送程序,用户无需改动
		try {
			System.out.println("eamil:" + to);
			Properties props = new Properties();
			props.put("mail.smtp.host", smtphost);
			props.put("mail.smtp.auth", "true");
			if (smtphost.indexOf("smtp.gmail.com") >= 0) {
				props.setProperty("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
				props.setProperty("mail.smtp.socketFactory.fallback", "false");
				props.setProperty("mail.smtp.port", "465");
				props.setProperty("mail.smtp.socketFactory.port", "465");
			}
			javax.mail.Session ssn = javax.mail.Session.getInstance(props, null);
			MimeMessage message = new MimeMessage(ssn);
			InternetAddress fromAddress = new InternetAddress(from);
			message.setFrom(fromAddress);
			InternetAddress toAddress = new InternetAddress(to);
			message.addRecipient(Message.RecipientType.TO, toAddress);
			message.setSubject(subject);
			message.setText(body);
			Transport transport = ssn.getTransport("smtp");
			transport.connect(smtphost, user, password);
			transport.sendMessage(message, message.getRecipients(Message.RecipientType.TO));
			transport.close();
			return true;
		} catch (Exception m) {
			m.printStackTrace();
		}
		return false;
	}

//	// apache email
	public static void sendMailByApache(String  to,String subject,String msg) {
		SimpleEmail email = new SimpleEmail();

		try {
			// email.setTLS(true); //是否TLS校验,,某些邮箱需要TLS安全校验,同理有SSL校验
			email.setSSL(true);
			email.setHostName(smtphost);
			email.setAuthentication(user, password); // 用户名和密码
			email.setSslSmtpPort("465");
			email.setFrom(from, password);
			email.setCharset("utf8");
			email.addTo(to); // 接收方
			// email.addCc(" aliyunzixun@xxx.com"); //抄送方
			// email.addBcc(" aliyunzixun@xxx.com"); //秘密抄送方
			email.setSubject(subject); // 标题
			email.setMsg(msg); // 内容
			email.send();

		} catch (EmailException e) {
			e.printStackTrace();
		} catch (Exception e) {
			e.printStackTrace();
		}
	}
}